/*******************************************************************************
** patch.h (patch settings)
*******************************************************************************/

#ifndef PATCH_H
#define PATCH_H

#include "bank.h"

enum
{
  PATCH_ALGORITHM_1C_CHAIN = 1, 
  PATCH_ALGORITHM_1C_THE_Y, 
  PATCH_ALGORITHM_1C_CRAB, 
  PATCH_ALGORITHM_2C_TWIN, 
  PATCH_ALGORITHM_2C_STACKED, 
  PATCH_ALGORITHM_3C_1_TO_3, 
  PATCH_ALGORITHM_3C_1_TO_1, 
  PATCH_ALGORITHM_4C_PIPES 
};

enum
{
  PATCH_HIGHPASS_CUTOFF_A0 = 0, 
  PATCH_HIGHPASS_CUTOFF_A1,
  PATCH_HIGHPASS_CUTOFF_A2,
  PATCH_HIGHPASS_CUTOFF_A3
};

enum
{
  PATCH_LOWPASS_CUTOFF_E7 = 0, 
  PATCH_LOWPASS_CUTOFF_G7,
  PATCH_LOWPASS_CUTOFF_A7,
  PATCH_LOWPASS_CUTOFF_C8
};

enum
{
  PATCH_OSC_WAVEFORM_SINE = 1, 
  PATCH_OSC_WAVEFORM_HALF, 
  PATCH_OSC_WAVEFORM_FULL, 
  PATCH_OSC_WAVEFORM_QUARTER, 
  PATCH_OSC_WAVEFORM_ALTERNATING, 
  PATCH_OSC_WAVEFORM_CAMEL, 
  PATCH_OSC_WAVEFORM_SQUARE, 
  PATCH_OSC_WAVEFORM_LOG_SAW 
};

enum
{
  PATCH_OSC_SYNC_OFF = 0, 
  PATCH_OSC_SYNC_0, 
  PATCH_OSC_SYNC_90, 
  PATCH_OSC_SYNC_180, 
  PATCH_OSC_SYNC_270 
};

enum
{
  PATCH_OSC_FREQ_MODE_RATIO = 0, 
  PATCH_OSC_FREQ_MODE_FIXED 
};

enum
{
  PATCH_KEYSCALING_MODE_KEY = 0, 
  PATCH_KEYSCALING_MODE_PITCH 
};

enum
{
  PATCH_LFO_WAVEFORM_TRIANGLE = 1, 
  PATCH_LFO_WAVEFORM_SQUARE, 
  PATCH_LFO_WAVEFORM_SAW_UP, 
  PATCH_LFO_WAVEFORM_SAW_DOWN, 
  PATCH_LFO_WAVEFORM_NOISE_SQUARE, 
  PATCH_LFO_WAVEFORM_NOISE_SAW 
};

enum
{
  PATCH_LFO_SYNC_OFF = 0, 
  PATCH_LFO_SYNC_ON 
};

enum
{
  PATCH_VIBRATO_MODE_UP_AND_DOWN = 1, 
  PATCH_VIBRATO_MODE_UP_ONLY
};

enum
{
  PATCH_TREMOLO_MODE_CARRIERS = 1, 
  PATCH_TREMOLO_MODE_MODULATORS
};

enum
{
  PATCH_BOOST_MODE_CARRIERS = 1, 
  PATCH_BOOST_MODE_MODULATORS
};

enum
{
  PATCH_CONTROLLER_EFFECT_VIBRATO = 1, 
  PATCH_CONTROLLER_EFFECT_TREMOLO, 
  PATCH_CONTROLLER_EFFECT_BOOST 
};

enum
{
  PATCH_PORTAMENTO_MODE_BEND = 1, 
  PATCH_PORTAMENTO_MODE_HALF_STEPS 
};

enum
{
  PATCH_PORTAMENTO_LEGATO_OFF = 0, 
  PATCH_PORTAMENTO_LEGATO_ON 
};

enum
{
  PATCH_PITCH_WHEEL_MODE_BEND = 1, 
  PATCH_PITCH_WHEEL_MODE_HALF_STEPS 
};

/* algorithm */
#define PATCH_ALGORITHM_DEFAULT     PATCH_ALGORITHM_1C_CHAIN
#define PATCH_ALGORITHM_LOWER_BOUND PATCH_ALGORITHM_1C_CHAIN
#define PATCH_ALGORITHM_UPPER_BOUND PATCH_ALGORITHM_4C_PIPES
#define PATCH_ALGORITHM_NUM_VALUES  (PATCH_ALGORITHM_UPPER_BOUND - PATCH_ALGORITHM_LOWER_BOUND + 1)

/* filters */
#define PATCH_HIGHPASS_CUTOFF_DEFAULT     PATCH_HIGHPASS_CUTOFF_A0
#define PATCH_HIGHPASS_CUTOFF_LOWER_BOUND PATCH_HIGHPASS_CUTOFF_A0
#define PATCH_HIGHPASS_CUTOFF_UPPER_BOUND PATCH_HIGHPASS_CUTOFF_A3
#define PATCH_HIGHPASS_CUTOFF_NUM_VALUES  (PATCH_HIGHPASS_CUTOFF_UPPER_BOUND - PATCH_HIGHPASS_CUTOFF_LOWER_BOUND + 1)

#define PATCH_LOWPASS_CUTOFF_DEFAULT      PATCH_LOWPASS_CUTOFF_C8
#define PATCH_LOWPASS_CUTOFF_LOWER_BOUND  PATCH_LOWPASS_CUTOFF_E7
#define PATCH_LOWPASS_CUTOFF_UPPER_BOUND  PATCH_LOWPASS_CUTOFF_C8
#define PATCH_LOWPASS_CUTOFF_NUM_VALUES   (PATCH_LOWPASS_CUTOFF_UPPER_BOUND - PATCH_LOWPASS_CUTOFF_LOWER_BOUND + 1)

/* pedal */
#define PATCH_PEDAL_SHIFT_DEFAULT       1
#define PATCH_PEDAL_SHIFT_LOWER_BOUND   1
#define PATCH_PEDAL_SHIFT_UPPER_BOUND   16
#define PATCH_PEDAL_SHIFT_NUM_VALUES    (PATCH_PEDAL_SHIFT_UPPER_BOUND - PATCH_PEDAL_SHIFT_LOWER_BOUND + 1)

/* oscillators */
#define PATCH_OSC_WAVEFORM_DEFAULT      PATCH_OSC_WAVEFORM_SINE
#define PATCH_OSC_WAVEFORM_LOWER_BOUND  PATCH_OSC_WAVEFORM_SINE
#define PATCH_OSC_WAVEFORM_UPPER_BOUND  PATCH_OSC_WAVEFORM_LOG_SAW
#define PATCH_OSC_WAVEFORM_NUM_VALUES   (PATCH_OSC_WAVEFORM_UPPER_BOUND - PATCH_OSC_WAVEFORM_LOWER_BOUND + 1)

#define PATCH_OSC_FEEDBACK_DEFAULT      0
#define PATCH_OSC_FEEDBACK_LOWER_BOUND  0
#define PATCH_OSC_FEEDBACK_UPPER_BOUND  7
#define PATCH_OSC_FEEDBACK_NUM_VALUES   (PATCH_OSC_FEEDBACK_UPPER_BOUND - PATCH_OSC_FEEDBACK_LOWER_BOUND + 1)

#define PATCH_OSC_SYNC_DEFAULT      PATCH_OSC_SYNC_0
#define PATCH_OSC_SYNC_LOWER_BOUND  PATCH_OSC_SYNC_OFF
#define PATCH_OSC_SYNC_UPPER_BOUND  PATCH_OSC_SYNC_270
#define PATCH_OSC_SYNC_NUM_VALUES   (PATCH_OSC_SYNC_UPPER_BOUND - PATCH_OSC_SYNC_LOWER_BOUND + 1)

#define PATCH_OSC_FREQ_MODE_DEFAULT       PATCH_OSC_FREQ_MODE_RATIO
#define PATCH_OSC_FREQ_MODE_LOWER_BOUND   PATCH_OSC_FREQ_MODE_RATIO
#define PATCH_OSC_FREQ_MODE_UPPER_BOUND   PATCH_OSC_FREQ_MODE_FIXED
#define PATCH_OSC_FREQ_MODE_NUM_VALUES    (PATCH_OSC_FREQ_MODE_UPPER_BOUND - PATCH_OSC_FREQ_MODE_LOWER_BOUND + 1)

#define PATCH_OSC_MULTIPLE_DEFAULT      1
#define PATCH_OSC_MULTIPLE_LOWER_BOUND  1
#define PATCH_OSC_MULTIPLE_UPPER_BOUND  16
#define PATCH_OSC_MULTIPLE_NUM_VALUES   (PATCH_OSC_MULTIPLE_UPPER_BOUND - PATCH_OSC_MULTIPLE_LOWER_BOUND + 1)

#define PATCH_OSC_DIVISOR_DEFAULT       1
#define PATCH_OSC_DIVISOR_LOWER_BOUND   1
#define PATCH_OSC_DIVISOR_UPPER_BOUND   8
#define PATCH_OSC_DIVISOR_NUM_VALUES    (PATCH_OSC_DIVISOR_UPPER_BOUND - PATCH_OSC_DIVISOR_LOWER_BOUND + 1)

#define PATCH_OSC_NOTE_DEFAULT          1
#define PATCH_OSC_NOTE_LOWER_BOUND      1
#define PATCH_OSC_NOTE_UPPER_BOUND      12
#define PATCH_OSC_NOTE_NUM_VALUES       (PATCH_OSC_NOTE_UPPER_BOUND - PATCH_OSC_NOTE_LOWER_BOUND + 1)

#define PATCH_OSC_OCTAVE_DEFAULT        4
#define PATCH_OSC_OCTAVE_LOWER_BOUND   -4
#define PATCH_OSC_OCTAVE_UPPER_BOUND    9
#define PATCH_OSC_OCTAVE_NUM_VALUES     (PATCH_OSC_OCTAVE_UPPER_BOUND - PATCH_OSC_OCTAVE_LOWER_BOUND + 1)

#define PATCH_OSC_DETUNE_DEFAULT        0
#define PATCH_OSC_DETUNE_LOWER_BOUND   -16
#define PATCH_OSC_DETUNE_UPPER_BOUND    16
#define PATCH_OSC_DETUNE_NUM_VALUES     (PATCH_OSC_DETUNE_UPPER_BOUND - PATCH_OSC_DETUNE_LOWER_BOUND + 1)

/* envelopes */
#define PATCH_ENV_RATE_DEFAULT      32
#define PATCH_ENV_RATE_LOWER_BOUND  1
#define PATCH_ENV_RATE_UPPER_BOUND  32
#define PATCH_ENV_RATE_NUM_VALUES   (PATCH_ENV_RATE_UPPER_BOUND - PATCH_ENV_RATE_LOWER_BOUND + 1)

#define PATCH_ENV_AMPLITUDE_DEFAULT     0
#define PATCH_ENV_AMPLITUDE_LOWER_BOUND 0
#define PATCH_ENV_AMPLITUDE_UPPER_BOUND 32
#define PATCH_ENV_AMPLITUDE_NUM_VALUES  (PATCH_ENV_AMPLITUDE_UPPER_BOUND - PATCH_ENV_AMPLITUDE_LOWER_BOUND + 1)

#define PATCH_ENV_SUSTAIN_DEFAULT       0
#define PATCH_ENV_SUSTAIN_LOWER_BOUND   0
#define PATCH_ENV_SUSTAIN_UPPER_BOUND   16
#define PATCH_ENV_SUSTAIN_NUM_VALUES    (PATCH_ENV_SUSTAIN_UPPER_BOUND - PATCH_ENV_SUSTAIN_LOWER_BOUND + 1)

/* keyscaling */
#define PATCH_KEYSCALING_MODE_DEFAULT       PATCH_KEYSCALING_MODE_PITCH
#define PATCH_KEYSCALING_MODE_LOWER_BOUND   PATCH_KEYSCALING_MODE_KEY
#define PATCH_KEYSCALING_MODE_UPPER_BOUND   PATCH_KEYSCALING_MODE_PITCH
#define PATCH_KEYSCALING_MODE_NUM_VALUES    (PATCH_KEYSCALING_MODE_UPPER_BOUND - PATCH_KEYSCALING_MODE_LOWER_BOUND + 1)

#define PATCH_KEYSCALING_DEPTH_DEFAULT      1
#define PATCH_KEYSCALING_DEPTH_LOWER_BOUND  1
#define PATCH_KEYSCALING_DEPTH_UPPER_BOUND  8
#define PATCH_KEYSCALING_DEPTH_NUM_VALUES   (PATCH_KEYSCALING_DEPTH_UPPER_BOUND - PATCH_KEYSCALING_DEPTH_LOWER_BOUND + 1)

#define PATCH_KEYSCALING_BREAK_POINT_DEFAULT      5
#define PATCH_KEYSCALING_BREAK_POINT_LOWER_BOUND  1
#define PATCH_KEYSCALING_BREAK_POINT_UPPER_BOUND  16
#define PATCH_KEYSCALING_BREAK_POINT_NUM_VALUES   (PATCH_KEYSCALING_BREAK_POINT_UPPER_BOUND - PATCH_KEYSCALING_BREAK_POINT_LOWER_BOUND + 1)

/* lfo */
#define PATCH_LFO_WAVEFORM_DEFAULT      PATCH_LFO_WAVEFORM_TRIANGLE
#define PATCH_LFO_WAVEFORM_LOWER_BOUND  PATCH_LFO_WAVEFORM_TRIANGLE
#define PATCH_LFO_WAVEFORM_UPPER_BOUND  PATCH_LFO_WAVEFORM_NOISE_SAW
#define PATCH_LFO_WAVEFORM_NUM_VALUES   (PATCH_LFO_WAVEFORM_UPPER_BOUND - PATCH_LFO_WAVEFORM_LOWER_BOUND + 1)

#define PATCH_LFO_FREQUENCY_DEFAULT     1
#define PATCH_LFO_FREQUENCY_LOWER_BOUND 1
#define PATCH_LFO_FREQUENCY_UPPER_BOUND 32
#define PATCH_LFO_FREQUENCY_NUM_VALUES  (PATCH_LFO_FREQUENCY_UPPER_BOUND - PATCH_LFO_FREQUENCY_LOWER_BOUND + 1)

#define PATCH_LFO_DELAY_DEFAULT     0
#define PATCH_LFO_DELAY_LOWER_BOUND 0
#define PATCH_LFO_DELAY_UPPER_BOUND 24
#define PATCH_LFO_DELAY_NUM_VALUES  (PATCH_LFO_DELAY_UPPER_BOUND - PATCH_LFO_DELAY_LOWER_BOUND + 1)

#define PATCH_LFO_SYNC_DEFAULT      PATCH_LFO_SYNC_OFF
#define PATCH_LFO_SYNC_LOWER_BOUND  PATCH_LFO_SYNC_OFF
#define PATCH_LFO_SYNC_UPPER_BOUND  PATCH_LFO_SYNC_ON
#define PATCH_LFO_SYNC_NUM_VALUES   (PATCH_LFO_SYNC_UPPER_BOUND - PATCH_LFO_SYNC_LOWER_BOUND + 1)

#define PATCH_LFO_QUANTIZE_DEFAULT      32
#define PATCH_LFO_QUANTIZE_LOWER_BOUND  1
#define PATCH_LFO_QUANTIZE_UPPER_BOUND  32
#define PATCH_LFO_QUANTIZE_NUM_VALUES   (PATCH_LFO_QUANTIZE_UPPER_BOUND - PATCH_LFO_QUANTIZE_LOWER_BOUND + 1)

/* vibrato / tremolo / boost */
#define PATCH_EFFECT_DEPTH_DEFAULT      1
#define PATCH_EFFECT_DEPTH_LOWER_BOUND  1
#define PATCH_EFFECT_DEPTH_UPPER_BOUND  16
#define PATCH_EFFECT_DEPTH_NUM_VALUES   (PATCH_EFFECT_DEPTH_UPPER_BOUND - PATCH_EFFECT_DEPTH_LOWER_BOUND + 1)

#define PATCH_EFFECT_BASE_DEFAULT       0
#define PATCH_EFFECT_BASE_LOWER_BOUND   0
#define PATCH_EFFECT_BASE_UPPER_BOUND   16
#define PATCH_EFFECT_BASE_NUM_VALUES    (PATCH_EFFECT_BASE_UPPER_BOUND - PATCH_EFFECT_BASE_LOWER_BOUND + 1)

#define PATCH_VIBRATO_MODE_DEFAULT      PATCH_VIBRATO_MODE_UP_AND_DOWN
#define PATCH_VIBRATO_MODE_LOWER_BOUND  PATCH_VIBRATO_MODE_UP_AND_DOWN
#define PATCH_VIBRATO_MODE_UPPER_BOUND  PATCH_VIBRATO_MODE_UP_ONLY
#define PATCH_VIBRATO_MODE_NUM_VALUES   (PATCH_VIBRATO_MODE_UPPER_BOUND - PATCH_VIBRATO_MODE_LOWER_BOUND + 1)

#define PATCH_TREMOLO_MODE_DEFAULT      PATCH_TREMOLO_MODE_CARRIERS
#define PATCH_TREMOLO_MODE_LOWER_BOUND  PATCH_TREMOLO_MODE_CARRIERS
#define PATCH_TREMOLO_MODE_UPPER_BOUND  PATCH_TREMOLO_MODE_MODULATORS
#define PATCH_TREMOLO_MODE_NUM_VALUES   (PATCH_TREMOLO_MODE_UPPER_BOUND - PATCH_TREMOLO_MODE_LOWER_BOUND + 1)

#define PATCH_BOOST_MODE_DEFAULT      PATCH_BOOST_MODE_CARRIERS
#define PATCH_BOOST_MODE_LOWER_BOUND  PATCH_BOOST_MODE_CARRIERS
#define PATCH_BOOST_MODE_UPPER_BOUND  PATCH_BOOST_MODE_MODULATORS
#define PATCH_BOOST_MODE_NUM_VALUES   (PATCH_BOOST_MODE_UPPER_BOUND - PATCH_BOOST_MODE_LOWER_BOUND + 1)

/* mod wheel / aftertouch */
#define PATCH_CONTROLLER_EFFECT_DEFAULT     PATCH_CONTROLLER_EFFECT_VIBRATO
#define PATCH_CONTROLLER_EFFECT_LOWER_BOUND PATCH_CONTROLLER_EFFECT_VIBRATO
#define PATCH_CONTROLLER_EFFECT_UPPER_BOUND PATCH_CONTROLLER_EFFECT_BOOST
#define PATCH_CONTROLLER_EFFECT_NUM_VALUES  (PATCH_CONTROLLER_EFFECT_UPPER_BOUND - PATCH_CONTROLLER_EFFECT_LOWER_BOUND + 1)

/* portamento */
#define PATCH_PORTAMENTO_MODE_DEFAULT       PATCH_PORTAMENTO_MODE_BEND
#define PATCH_PORTAMENTO_MODE_LOWER_BOUND   PATCH_PORTAMENTO_MODE_BEND
#define PATCH_PORTAMENTO_MODE_UPPER_BOUND   PATCH_PORTAMENTO_MODE_HALF_STEPS
#define PATCH_PORTAMENTO_MODE_NUM_VALUES    (PATCH_PORTAMENTO_MODE_UPPER_BOUND - PATCH_PORTAMENTO_MODE_LOWER_BOUND + 1)

#define PATCH_PORTAMENTO_LEGATO_DEFAULT     PATCH_PORTAMENTO_LEGATO_OFF
#define PATCH_PORTAMENTO_LEGATO_LOWER_BOUND PATCH_PORTAMENTO_LEGATO_OFF
#define PATCH_PORTAMENTO_LEGATO_UPPER_BOUND PATCH_PORTAMENTO_LEGATO_ON
#define PATCH_PORTAMENTO_LEGATO_NUM_VALUES  (PATCH_PORTAMENTO_LEGATO_UPPER_BOUND - PATCH_PORTAMENTO_LEGATO_LOWER_BOUND + 1)

#define PATCH_PORTAMENTO_SPEED_DEFAULT      1
#define PATCH_PORTAMENTO_SPEED_LOWER_BOUND  1
#define PATCH_PORTAMENTO_SPEED_UPPER_BOUND  16
#define PATCH_PORTAMENTO_SPEED_NUM_VALUES   (PATCH_PORTAMENTO_SPEED_UPPER_BOUND - PATCH_PORTAMENTO_SPEED_LOWER_BOUND + 1)

/* pitch wheel */
#define PATCH_PITCH_WHEEL_MODE_DEFAULT      PATCH_PITCH_WHEEL_MODE_BEND
#define PATCH_PITCH_WHEEL_MODE_LOWER_BOUND  PATCH_PITCH_WHEEL_MODE_BEND
#define PATCH_PITCH_WHEEL_MODE_UPPER_BOUND  PATCH_PITCH_WHEEL_MODE_HALF_STEPS
#define PATCH_PITCH_WHEEL_MODE_NUM_VALUES   (PATCH_PITCH_WHEEL_MODE_UPPER_BOUND - PATCH_PITCH_WHEEL_MODE_LOWER_BOUND + 1)

#define PATCH_PITCH_WHEEL_RANGE_DEFAULT      1
#define PATCH_PITCH_WHEEL_RANGE_LOWER_BOUND  1
#define PATCH_PITCH_WHEEL_RANGE_UPPER_BOUND  12
#define PATCH_PITCH_WHEEL_RANGE_NUM_VALUES   (PATCH_PITCH_WHEEL_RANGE_UPPER_BOUND - PATCH_PITCH_WHEEL_RANGE_LOWER_BOUND + 1)

typedef struct patch
{
  /* algorithm */
  short int algorithm;

  /* filters */
  short int highpass_cutoff;
  short int lowpass_cutoff;

  /* pedal */
  short int pedal_shift;

  /* oscillators */
  short int osc_waveform[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_feedback[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_sync[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_freq_mode[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_multiple[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_divisor[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_note[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_octave[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int osc_detune[BANK_OSCS_AND_ENVS_PER_VOICE];

  /* envelopes */
  short int env_attack[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int env_decay_1[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int env_decay_2[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int env_release[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int env_amplitude[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int env_sustain[BANK_OSCS_AND_ENVS_PER_VOICE];

  /* keyscaling */
  short int ks_mode[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int ks_rate_depth[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int ks_level_depth[BANK_OSCS_AND_ENVS_PER_VOICE];
  short int ks_break_point[BANK_OSCS_AND_ENVS_PER_VOICE];

  /* lfo */
  short int lfo_waveform;
  short int lfo_frequency;
  short int lfo_delay;
  short int lfo_sync;
  short int lfo_quantize;

  /* vibrato / tremolo / boost */
  short int vibrato_depth;
  short int vibrato_base;
  short int vibrato_mode;

  short int tremolo_depth;
  short int tremolo_base;
  short int tremolo_mode;

  short int boost_depth;
  short int boost_mode;

  /* mod wheel / aftertouch */
  short int mod_wheel_effect;
  short int aftertouch_effect;

  /* portamento */
  short int portamento_mode;
  short int portamento_legato;
  short int portamento_speed;

  /* pitch wheel */
  short int pitch_wheel_mode;
  short int pitch_wheel_range;
} patch;

/* patch bank */
extern patch G_patch_bank[BANK_NUM_PATCHES];

/* function declarations */
short int patch_setup_all();
short int patch_reset(int patch_index);

short int patch_validate(int patch_index);

#endif
